# 타임리프 소개

---

## 타임리프 특징

+ 서버 사이드 HTML 렌더링 (SSR)
+ 네츄럴 템플릿
+ 스프링 통합 지원

### 서버 사이드 HTML 렌더링 (SSR)

타임리프는 백엔드 서버에서 HTML을 동적으로 렌더링 하는 용도로 사용된다.

### 네츄럴 템플릿

타임리프는 순수 HTML을 최대한 유지하는 특징이 있다.

타임리프로 작성한 파일은 HTML을 유지하기 때문에 웹 브라우저에서 파일을 직접 열어 확인할 수 있고, 서버를 통해 동적으로 변경된 결과를 확인할 수 있다.

### 스프링 통합 지원

타임리피는 스프링과 자연스럽게 통합되고, 스프링의 다양한 기능을 편리하게 사용할 수 있게 지원한다.

---

## 타임리프 기본 기능

**타임리프 사용 선언**

`<html xmlns:th="http://www.thymeleaf.org">`

```text
• 간단한 표현:
    ◦ 변수 표현식: ${...}
    ◦ 선택 변수 표현식: *{...}
    ◦ 메시지 표현식: #{...}
    ◦ 링크 URL 표현식: @{...}
    ◦ 조각 표현식: ~{...}
• 리터럴
    ◦ 텍스트: 'one text', 'Another one!',…
    ◦ 숫자: 0, 34, 3.0, 12.3,…
    ◦ 불린: true, false
    ◦ 널: null
    ◦ 리터럴 토큰: one, sometext, main,…
• 문자 연산:
    ◦ 문자 합치기: +
    ◦ 리터럴 대체: |The name is ${name}|
• 산술 연산:
    ◦ Binary operators: +, -, *, /, %
    ◦ Minus sign (unary operator): -
• 불린 연산:
    ◦ Binary operators: and, or
    ◦ Boolean negation (unary operator): !, not
• 비교와 동등:
    ◦ 비교: >, <, >=, <= (gt, lt, ge, le)
    ◦ 동등 연산: ==, != (eq, ne)
• 조건 연산:
    ◦ If-then: (if) ? (then)
    ◦ If-then-else: (if) ? (then) : (else)
    ◦ Default: (value) ?: (defaultvalue)
• 특별한 토큰:
    ◦ No-Operation: _
```

---

## 테스트 - text, utext

텍스트츨 출력하는 기능

HTML의 콘텐츠에 데이터를 출력할 때는 `th:text`를 사용한다.

`<span th:text="${data}">`

HTML 태그의 속성이 아니라 HTML 콘텐츠 영역안에 직접 데이터를 출력하고 싶으면 `[[...]]`을 사용한다.

`[[${data}]]`

### Escape

HTML 문서는 `<`, `>`와 같은 특수 문자를 기반으로 정의된다.

`"Hello <b>Spring!</b>"`로 입력하고 웹 브라우저에서 소스를 보면 `<` 부분이 `&lt;`로 변경되면서 웹 브라우저에 `<b>`가 그대로 나온다.

### HTML 엔티티

웹 브라우저는 `<`를 HTML 태그의 시작으로 인식한다. 따라서 `<`를 태그의 시작이 아니라 문자로 표현할 수 있는 방법이 필요한데, 이것을 HTML 엔티티라고 한다.

HTML에서 사용하는 특수문자를 HTML 엔티티로 변경하는 것을 이스케이스(escape)라 한다.

타임리프가 제공하는 `th:text`,`[[...]]는 기본적으로 **이스케이프(escape)** 를 제공한다.

그래서 타임리프는 이스케이프 기능을 사용하고 싶지 않을때 사용할 수 있는 기능 두 가지를 제공한다.

+ `th:text` -> `th:utext`
+ `[[...]]` -> `[(...)]

```html
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<h1>text vs utext</h1>
<ul>
    <li>th:text = <span th:text="${data}"></span></li>
    <li>th:utext = <span th:utext="${data}"></span></li>
</ul>
<h1><span th:inline="none">[[...]] vs [(...)]</span></h1>
<ul>
    <li><span th:inline="none">[[...]] = </span>[[${data}]]</li>
    <li><span th:inline="none">[(...)] = </span>[(${data})]</li>
</ul>
</body>
</html>
```

> 주의!
>
> 실제 서비스를 개발하다 보면 escape를 사용하지 않아서 HTML이 정상 렌더링 되지 않는 문제가 발생할 수 있다.
>
> escape를 기본으로 하고, 꼭 필요할 때만 unescape 를 사용하자.

---

## 변수 - SpringEL

타임리프에서 변수를 사용할 때는 변수 표현식을 사용한다.

---

### 변수 표현식:`${...}`

이 변수 표현식에는 스프링 EL 이라는 스프링이 제공하는 표현식을 사용할 수 있다.

```java
    @GetMapping("/variable")
public String variable(Model model){
        User userA=new User("userA",10);
        User userB=new User("userB",20);

        List<User> list=new ArrayList<>();
        list.add(userA);
        list.add(userB);

        Map<String, User> map=new HashMap<>();
        map.put("userA",userA);
        map.put("userB",userB);

        model.addAttribute("user",userA);
        model.addAttribute("users",list);
        model.addAttribute("userMap",map);

        return"basic/variable";

        }

@Data
static class User {
    private String username;
    private int age;

    public User(String username, int age) {
        this.username = username;
        this.age = age;
    }
}
```

```html
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<h1>SpringEL 표현식</h1>
<ul>Object
    <li>${user.username} = <span th:text="${user.username}"></span></li>
    <li>${user['username']} = <span th:text="${user['username']}"></span></li>
    <li>${user.getUsername()} = <span th:text="${user.getUsername()}"></span></li>
</ul>
<ul>List
    <li>${users[0].username} = <span th:text="${users[0].username}"></span></li>
    <li>${users[0]['username']} = <span th:text="${users[0]['username']}"></span></li>
    <li>${users[0].getUsername()} = <span th:text="${users[0].getUsername()}"></span></li>
</ul>
<ul>Map
    <li>${userMap['userA'].username} = <span th:text="${userMap['userA'].username}"></span></li>
    <li>${userMap['userA']['username']} = <span th:text="${userMap['userA']['username']}"></span></li>
    <li>${userMap['userA'].getUsername()} = <span th:text="${userMap['userA'].getUsername()}"></span></li>
</ul>

<h1>지역 변수 - (th:with)</h1>
<div th:with="first=${users[0]}">
    <p>처음 사람의 이름은 <span th:text="${first.username}"></span></p>
</div>
</body>
</html>
```

### Object

+ `user.username`: User의 프로퍼티 접근 -> `user.getUsername()`
+ `user['username']`: 위와 같음
+ `user.getUsername()`: `getUsername()`을 직접 호출

### List

+ `users[0].username`: List의 첫 번째 유저를 찾아 프로퍼티 접근
+ `users[0]['username']`
+ `users[0].getUsername()`

### MAP

+ `userMap['userA'].username`: Map에서 userA를 찾고 프로퍼티 접근
+ `userMap['userA']['username']`
+ `userMap['userA'].getUsername()`

### 지역 변수 선언

`th:with`를 사용하면 지역 변수를 선언할 수 있다. 지역 변수는 선언한 태그 안에서만 사용이 가능하다.


---

## 기본 객체들

타임리프는 기본 객체들을 제공한다.

+ `${#request}`
+ `${#response}`
+ `${#session}`
+ `${#servletContext}`
+ `${#locale}`

### 편의 객체

+ HTTP 요청 파라미터 접근:`param`
    + ex) `${param.paramData}`
+ HTTP 세션 접근: `session`
    + ex) `${session.sessionData}`
+ 스프링 빈 접근: `@`
    + ex) `${@helloBean.hello('Spring!')}`

```java
    @GetMapping("/basic-objects")
public String basicObject(HttpSession session){
        session.setAttribute("sessionData","Hello Session");

        return"basic/basic-objects";
        }

@Component("helloBean")
static class HelloBean {
    public String hello(String data) {
        return "Hello " + data;
    }
}
```

`실행: http://localhost:8080/basic/basic-objects?paramData=HelloParam`

---

## 유틸리티 객체와 날짜

```java
    @GetMapping("/date")
public String date(Model model){
        model.addAttribute("localDateTime",LocalDateTime.now());

        return"basic/date";
        }
```

```html
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<h1>LocalDateTime</h1>
<ul>
    <li>default = <span th:text="${localDateTime}"></span></li>
    <li>yyyy-MM-dd HH:mm:ss = <span th:text="${#temporals.format(localDateTime,'yyyy-MM-dd HH:mm:ss')}"></span></li>
</ul>
<h1>LocalDateTime - Utils</h1>
<ul>
    <li>${#temporals.day(localDateTime)} = <span th:text="${#temporals.day(localDateTime)}"></span></li>
    <li>${#temporals.month(localDateTime)} = <span th:text="${#temporals.month(localDateTime)}"></span></li>
    <li>${#temporals.monthName(localDateTime)} = <span th:text="${#temporals.monthName(localDateTime)}"></span></li>
    <li>${#temporals.monthNameShort(localDateTime)} = <span
            th:text="${#temporals.monthNameShort(localDateTime)}"></span></li>
    <li>${#temporals.year(localDateTime)} = <span th:text="${#temporals.year(localDateTime)}"></span></li>
    <li>${#temporals.dayOfWeek(localDateTime)} = <span th:text="${#temporals.dayOfWeek(localDateTime)}"></span></li>
    <li>${#temporals.dayOfWeekName(localDateTime)} = <span th:text="${#temporals.dayOfWeekName(localDateTime)}"></span>
    </li>
    <li>${#temporals.dayOfWeekNameShort(localDateTime)} = <span
            th:text="${#temporals.dayOfWeekNameShort(localDateTime)}"></span></li>
    <li>${#temporals.hour(localDateTime)} = <span th:text="${#temporals.hour(localDateTime)}"></span></li>
    <li>${#temporals.minute(localDateTime)} = <span th:text="${#temporals.minute(localDateTime)}"></span></li>
    <li>${#temporals.second(localDateTime)} = <span th:text="${#temporals.second(localDateTime)}"></span></li>
    <li>${#temporals.nanosecond(localDateTime)} = <span th:text="${#temporals.nanosecond(localDateTime)}"></span></li>
</ul>
</body>
</html>
```

---

## URL 링크

URL을 생성할 때는 `@{...}`문법을 사용한다.

```java
    @GetMapping("link")
    public String link(Model model){
        model.addAttribute("param1","data1");
        model.addAttribute("param2","data2");

        return"basic/link";
    }
```

```html
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<h1>URL 링크</h1>
<ul>
    <li><a th:href="@{/hello}">basic url</a></li>
    <li><a th:href="@{/hello(param1=${param1}, param2=${param2})}">hello query param</a></li>
    <li><a th:href="@{/hello/{param1}/{param2}(param1=${param1}, param2=${param2})}">path variable</a></li>
    <li><a th:href="@{/hello/{param1}(param1=${param1}, param2=${param2})}">path variable + query parameter</a></li>
</ul>
</body>
</html>
```

### 단순 URL

`@{/hello}` -> `/hello`

### 쿼리 파라미터

`@{/hello(param1=${param1}, param2=${param2})}`
  
+ -> `/hello?param1=data1&param2=data2`


### 경로 변수
`@{/hello/{param1}(param1=${param1}, param2=${param2})}`

+ -> `/hello/data1?param2=data2`

---

## 리터럴

리터럴은 소스 코드상에 고정된 값을 말하는 용어이다.

`"Hello"`는 문자 리터럴, `10`,`20`은 숫자 리터럴 

+ 문자: `hello`
+ 숫자: `10`
+ 불린: `true`,`false`
+ null: `null`

문자 리터럴은 항상 `'`(작은 따옴표)로 감싸야 한다.

`<span th:text="`hello`">`

그러나 공백 없이 쭉 이어진다면 하나의 의미있는 토큰으로 인지해서 생략할 수 있다.

`<span th:text="hello">`

### 오류

`<span th:text="hello world!"></span>`

문자 리터럴은 `'`로 감싸야 하는데 중간에 공백이 있어서 의미있는 토큰으로 인식되지 않아 오류가 발생한다.

### 수정

`<span th:text="'hello world!'"></span>`

```java
@GetMapping("/literal")
    public String literal(Model model){
        model.addAttribute("data","Spring!");
        return "basic/literal";
    }
```


```html
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<h1>리터럴</h1>
<ul>
    <!--주의! 다음 주석을 풀면 예외가 발생함-->
    <!-- <li>"hello world!" = <span th:text="hello world!"></span></li>-->
    <li>'hello' + ' world!' = <span th:text="'hello' + ' world!'"></span></li>
    <li>'hello world!' = <span th:text="'hello world!'"></span></li>
    <li>'hello ' + ${data} = <span th:text="'hello ' + ${data}"></span></li>
    <li>리터럴 대체 |hello ${data}| = <span th:text="|hello ${data}|"></span></li>
</ul>
</body>
</html>
```

### 리터럴 대체(Literal substitutions)

`<span th:text="|hello ${data}|">` 리터럴 대체 문법을 사용하면 템플릿처럼 사용할 수 있다.

---

## 연산

HTML안에서 사용할 때는 HTML 엔티티를 사용하는 부분을 주의하자.

---

```java
@GetMapping("/operation")
    public String operation(Model model){
        model.addAttribute("nullData",null);
        model.addAttribute("data","Spring!");
        return "basic/operation";
    }
```

```html
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<ul>
    <li>산술 연산
        <ul>
            <li>10 + 2 = <span th:text="10 + 2"></span></li>
            <li>10 % 2 == 0 = <span th:text="10 % 2 == 0"></span></li>
        </ul>
    </li>
    <li>비교 연산
        <ul>
            <li>1 > 10 = <span th:text="1 &gt; 10"></span></li>
            <li>1 gt 10 = <span th:text="1 gt 10"></span></li>
            <li>1 >= 10 = <span th:text="1 >= 10"></span></li>
            <li>1 ge 10 = <span th:text="1 ge 10"></span></li>
            <li>1 == 10 = <span th:text="1 == 10"></span></li>
            <li>1 != 10 = <span th:text="1 != 10"></span></li>
        </ul>
    </li>
    <li>조건식
        <ul>
            <li>(10 % 2 == 0)? '짝수':'홀수' = <span th:text="(10 % 2 == 0)?'짝수':'홀수'"></span></li>
        </ul>
    </li>
    <li>Elvis 연산자
        <ul>
            <li>${data}?: '데이터가 없습니다.' = <span th:text="${data}?: '데이터가 없습니다.'"></span></li>
            <li>${nullData}?: '데이터가 없습니다.' = <span th:text="${nullData}?:'데이터가 없습니다.'"></span></li>
        </ul>
    </li>
    <li>No-Operation
        <ul>
            <li>${data}?: _ = <span th:text="${data}?: _">데이터가 없습니다.</span></li>
            <li>${nullData}?: _ = <span th:text="${nullData}?: _">데이터가 없습니다.</span></li>
        </ul>
    </li>
</ul>
</body>
</html>
```

+ Elvis 연산자 : 조건식의 편의 버전
+ No-Operation: `_`인 경우 타임리프가 실행되지 않는 것 처럼 동작한다.

---

## 속성 값 설정

타임리프 태그 속성(Attribute)

타임리프는 HTML 태그에 `th:x`속성을 지정하는 방식으로 동작한다.

속성을 적용하면 기존 속성을 대체하고 없으면 새로 만든다.

---

```html
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<h1>속성 설정</h1>
<input type="text" name="mock" th:name="userA"/>
<h1>속성 추가</h1>
- th:attrappend = <input type="text" class="text" th:attrappend="class=' large'"/><br/>
- th:attrprepend = <input type="text" class="text" th:attrprepend="class='large '"/><br/>
- th:classappend = <input type="text" class="text" th:classappend="large"/><br/>
<h1>checked 처리</h1>
- checked o <input type="checkbox" name="active" th:checked="true"/><br/>
- checked x <input type="checkbox" name="active" th:checked="false"/><br/>
- checked=false <input type="checkbox" name="active" checked="false"/><br/>
</body>
</html>
```


`th:attrappend`: 속성 값의 뒤에 값을 추가 
`th:attrprepend`: 속성 값의 앞에 값을 추가
`th:classappend`: class 속성에 자연스럽게 추가

### checked 처리

HTML은 `checked` 속성이 있으면 checked 속성 값과 상관없이 checked 처리 되어버린다.

`<input type="checkbox" name="active" th:checked="false" />`이 렌더링되면

`<input type="checkbox" name="active" />`

---

## 반복

`th:each`를 사용한다.

```java
    @GetMapping("/each")
    public String each(Model model) {
        addUsers(model);
        return "basic/each";
    }
    private void addUsers(Model model) {
        List<User> list = new ArrayList<>();
         list.add(new User("userA", 10));
        list.add(new User("userB", 20));
        list.add(new User("userC", 30));
        model.addAttribute("users", list);
    }
```

```html
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>Title</title>
</head>
<body>
<h1>기본 테이블</h1>
<table border="1">
  <tr>
    <th>username</th>
    <th>age</th>
  </tr>
  <tr th:each="user : ${users}">
    <td th:text="${user.username}">username</td>
    <td th:text="${user.age}">0</td>
  </tr>
</table>
<h1>반복 상태 유지</h1>
<table border="1">
  <tr>
    <th>count</th>
    <th>username</th>
    <th>age</th>
    <th>etc</th>
  </tr>
  <tr th:each="user, userStat : ${users}">
    <td th:text="${userStat.count}">username</td>
    <td th:text="${user.username}">username</td>
    <td th:text="${user.age}">0</td>
    <td>
      index = <span th:text="${userStat.index}"></span>
      count = <span th:text="${userStat.count}"></span>
      size = <span th:text="${userStat.size}"></span>
      even? = <span th:text="${userStat.even}"></span>
      odd? = <span th:text="${userStat.odd}"></span>
      first? = <span th:text="${userStat.first}"></span>
      last? = <span th:text="${userStat.last}"></span>
      current = <span th:text="${userStat.current}"></span>
    </td>
  </tr>
</table>
</body>
</html>
```

`<tr th:each="user : ${users}">`

users의 값을 하나씩 꺼내어 user에 담아준다.

### 반복 상태

`<tr th:each="user, userStat : ${users}">`

userStat는 생략 가능하다. 생략하면 user+ `Stat`의 변수명이 된다.

---

## 조건부 평가

```html
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<h1>if, unless</h1>
<table border="1">
    <tr>
        <th>count</th>
        <th>username</th>
        <th>age</th>
    </tr>
    <tr th:each="user, userStat : ${users}">
        <td th:text="${userStat.count}">1</td>
        <td th:text="${user.username}">username</td>
        <td>
            <span th:text="${user.age}">0</span>
            <span th:text="'미성년자'" th:if="${user.age lt 20}"></span>
            <span th:text="'미성년자'" th:unless="${user.age ge 20}"></span>
        </td>
    </tr>
</table>
<h1>switch</h1>
<table border="1">
    <tr>
        <th>count</th>
        <th>username</th>
        <th>age</th>
    </tr>
    <tr th:each="user, userStat : ${users}">
        <td th:text="${userStat.count}">1</td>
        <td th:text="${user.username}">username</td>
        <td th:switch="${user.age}">
            <span th:case="10">10살</span>
            <span th:case="20">20살</span>
            <span th:case="*">기타</span>
        </td>
    </tr>
</table>
</body>
</html>
```

`if`,`unless`는 조건이 맞지 않으면 렌더링 하지 않는다.

`*`은 `switch`문에서 조건이 없을때 사용하는 디폴트 이다.

---

## 주석

```html
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<h1>예시</h1>
<span th:text="${data}">html data</span>
<h1>1. 표준 HTML 주석</h1>
<!--
<span th:text="${data}">html data</span>
-->
<h1>2. 타임리프 파서 주석</h1>
<!--/* [[${data}]] */-->
<!--/*-->
<span th:text="${data}">html data</span>
<!--*/-->
<h1>3. 타임리프 프로토타입 주석</h1>
<!--/*/
<span th:text="${data}">html data</span>
/*/-->
</body>
</html>
```

### 1.표준 HTML 주석

자바스크립트의 표준 HTML 주석은 타임리프가 렌더링하지 않고 그대로 남겨둔다.


### 2.타임리프 파서 주석

타임리프의 진짜 주석. 렌더링 시에 주석 부분을 제거한다.

### 3. 타임리프 프로토타입 주석

HTML 파일을 웹브라우저에서 열어보면 이 부분이 웹 브라우저가 렌더링 하지 않는다.

타임리프 렌더링을 한 경우에만 효과가 생기는 기능이다.


---

## 블록

```html
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>Title</title>
</head>
<body>
<th:block th:each="user : ${users}">
  <div>
    사용자 이름1 <span th:text="${user.username}"></span>
    사용자 나이1 <span th:text="${user.age}"></span>
  </div>
  <div>
    요약 <span th:text="${user.username} + ' / ' + ${user.age}"></span>
  </div>
</th:block>
</body>
</html>
```

반복문처럼 태그별로 사용하기 애매할때 타임리프의 `th:block`기능을 사용한다.

---

## 자바스크립트 인라인

```html
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>Title</title>
</head>
<body>
<!-- 자바스크립트 인라인 사용 전 -->
<script>
  var username = [[${user.username}]];
  var age = [[${user.age}]];
  //자바스크립트 내추럴 템플릿
  var username2 = /*[[${user.username}]]*/ "test username";
  //객체
  var user = [[${user}]];
</script>
<!-- 자바스크립트 인라인 사용 후 -->
<script th:inline="javascript">
  var username = [[${user.username}]];
  var age = [[${user.age}]];
  //자바스크립트 내추럴 템플릿
  var username2 = /*[[${user.username}]]*/ "test username";
  //객체
  var user = [[${user}]];
</script>

<!-- 자바스크립트 인라인 each -->
<script th:inline="javascript">
  [# th:each="user, stat : ${users}"]
  var user[[${stat.count}]] = [[${user}]];
  [/]
</script>
</body>
</html>
```

---

## 템플릿 조각

웹 페이지의 공통 영역들을 템플릿 조각과 레이아웃 기능을 이용하여 효율적으로 개발할 수 있게 해준다.

fragment/footer.html

```html
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<body>
<footer th:fragment="copy">
    푸터 자리 입니다.
</footer>
<footer th:fragment="copyParam (param1, param2)">
    <p>파라미터 자리 입니다.</p>
    <p th:text="${param1}"></p>
    <p th:text="${param2}"></p>
</footer>
</body>
</html>
```

`th:fragment`: 다른곳에 포함되는 코드 조각

fragment/fragmentMain.html

```html
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<h1>부분 포함</h1>
<h2>부분 포함 insert</h2>
<div th:insert="~{template/fragment/footer :: copy}"></div>

<h2>부분 포함 replace</h2>
<div th:replace="~{template/fragment/footer :: copy}"></div>

<h2>부분 포함 단순 표현식</h2>
<div th:replace="template/fragment/footer :: copy"></div>

<h1>파라미터 사용</h1>
<div th:replace="~{template/fragment/footer :: copyParam ('데이터1', '데이터2')}"></div>
</body>
</html>
```

`template/fragment/footer :: copy` 해당 경로에 있는 `th:fragment="copy"라는 부분을 템플릿 조각으로 가져와서 사용한다는 의미

`th:insert` 현재 태그 내부에 추가

`th:reaplace`: 현재 태그를 대체

---

## 템플릿 레이아웃 1

일부 코드 조각을 가지고와서 사용하지 않고 코드 조각을 레이아웃에 넘겨서 사용하는 방법

layout/base.html

```html
<html xmlns:th="http://www.thymeleaf.org">
<head th:fragment="common_header(title,links)">
    <title th:replace="${title}">레이아웃 타이틀</title>
    <!-- 공통 -->
    <link rel="stylesheet" type="text/css" media="all" th:href="@{/css/awesomeapp.css}">
    <link rel="shortcut icon" th:href="@{/images/favicon.ico}">
    <script type="text/javascript" th:src="@{/sh/scripts/codebase.js}"></script>
    <!-- 추가 -->
    <th:block th:replace="${links}"/>
</head>
```

layout/layoutMain.html

```html
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="template/layout/base :: common_header(~{::title},~{::link})">
    <title>메인 타이틀</title>
    <link rel="stylesheet" th:href="@{/css/bootstrap.min.css}">
    <link rel="stylesheet" th:href="@{/themes/smoothness/jquery-ui.css}">
</head>
<body>
메인 컨텐츠
</body>
</html>
```

`common_header(~{::title},~{::link})`

+ `::title`: 현재 페이지의 title 태그들을 전달
+ `::link`: 현재 페이지의 link 태그들 전달

---

## 템플릿 레이아웃 2

layoutExtend/layoutFile.html

```html
<!DOCTYPE html>
<html th:fragment="layout (title, content)" xmlns:th="http://www.thymeleaf.org">
<head>
    <title th:replace="${title}">레이아웃 타이틀</title>
</head>
<body>
<h1>레이아웃 H1</h1>
<div th:replace="${content}">
    <p>레이아웃 컨텐츠</p>
</div>
<footer>
    레이아웃 푸터
</footer>
</body>
</html>
```

layoutExtend/layoutExtendMain.html


```html
<!DOCTYPE html>
<html th:replace="~{template/layoutExtend/layoutFile :: layout(~{::title}, ~{::section})}"
      xmlns:th="http://www.thymeleaf.org">
<head>
    <title>메인 페이지 타이틀</title>
</head>
<body>
<section>
    <p>메인 페이지 컨텐츠</p>
    <div>메인 페이지 포함 내용</div>
</section>
</body>
</html>
```